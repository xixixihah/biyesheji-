<view class="container">
  <!-- 顶部操作栏 -->
  <view class="action-bar">
    <button class="post-btn" bindtap="showPostModal" type="primary">
      发布帖子
    </button>
  </view>

  <!-- 帖子列表 -->
  <scroll-view 
    scroll-y 
    class="post-list"
    refresher-enabled="{{true}}"
    refresher-triggered="{{isRefreshing}}"
    bindrefresherrefresh="onRefresh"
    bindscrolltolower="loadMore">
    
    <view wx:for="{{posts}}" 
          wx:key="id" 
          class="post-item"
          bindtap="goToDetail"
          data-id="{{item.id}}">
      
      <view class="post-header">
        <image class="avatar" src="{{item.avatar_url}}" mode="aspectFill"></image>
        <view class="post-info">
          <text class="nickname">{{item.nickname}}</text>
          <text class="time">{{item.created_at}}</text>
        </view>
      </view>

      <view class="post-content">
        <text class="title">{{item.title}}</text>
        <text class="content">{{item.content}}</text>
      </view>

      <view class="post-footer">
        <view class="action">
          <text class="iconfont icon-comment"></text>
          <text>{{item.comment_count || 0}}</text>
        </view>
        <view class="action">
          <text class="iconfont icon-like"></text>
          <text>{{item.like_count || 0}}</text>
        </view>
      </view>
    </view>

    <!-- 加载更多 -->
    <view class="loading" wx:if="{{isLoading}}">
      <text>加载中...</text>
    </view>
  </scroll-view>

  <!-- 发帖弹窗 -->
  <view class="modal" wx:if="{{showPostModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text>发布新帖</text>
        <text class="close" bindtap="hidePostModal">×</text>
      </view>

      <view class="modal-body">
        <input 
          class="title-input" 
          placeholder="请输入标题" 
          value="{{newPost.title}}"
          bindinput="onTitleInput"
        />
        <textarea 
          class="content-input" 
          placeholder="请输入内容" 
          value="{{newPost.content}}"
          bindinput="onContentInput"
        />
      </view>

      <view class="modal-footer">
        <button 
          class="submit-btn" 
          type="primary" 
          loading="{{isSubmitting}}"
          bindtap="submitPost">
          发布
        </button>
      </view>
    </view>
  </view>
</view> 